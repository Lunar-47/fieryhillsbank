<!DOCTYPE html>
<html>
<head>
    <title>{{ student_name }}'s Balance</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <style>
        body { font-family: Arial, sans-serif; margin: 30px; }
        h1 { color: #602e87; margin-top: 10px; margin-bottom: 0px;} /* reduced space above title */
        table { border-collapse: collapse; width: 80%; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        th { background-color: #f2f2f2; }
        .balance { font-weight: bold; margin-top: 15px; }
        a { text-decoration: none; color: blue; }
        a:hover { text-decoration: underline; }
        
        /* Button Styles */
        .btn {
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.95em;
            border: none;
            text-decoration: none;
        }
        .edit-btn { background-color: #4CAF50; color: white; }
        .delete-btn { background-color: #f44336; color: white; }
        .add-btn { background-color: #4CAF50; color: white; } /* matches edit button */
        .back-btn { background-color: #602e87; color: white; }
        .btn:hover { opacity: 0.85; }

        .top-link { display: inline-block; margin-bottom: 10px; } /* tightened spacing */
    </style>
</head>
<body>
    <!-- Back to Dashboard -->
    <p class="top-link">
        <a href="{{ url_for('home') }}" class="btn back-btn">&larr; Back to Dashboard</a>
    </p>

    <h1>{{ student_name }} ({{ grade }})'s Balance</h1> <!-- Added grade here -->

    <h2 class="balance">Current Balance: {{ balance }} Hawkeyes</h2>

    <!-- Add Transaction Button -->
    <form action="{{ url_for('add_transaction', student_id=student_id) }}" method="get" style="display:inline;">
        <button type="submit" class="btn add-btn">Add Transaction</button>
    </form>
    
    <table>
        <tr>
            <th>Date</th>
            <th>Description</th>
            <th>Debit (-)</th>
            <th>Credit (+)</th>
            <th>Actions</th>
        </tr>
        {% for t in transactions %}
        <tr>
            <td>{{ t['date'] }}</td>
            <td>{{ t['description'] }}</td>
            <td>{{ t['debit'] }}</td>
            <td>{{ t['credit'] }}</td>
            <td>
                <a href="{{ url_for('edit_transaction', transaction_id=t.id, student_id=student_id) }}" class="btn edit-btn">Edit</a>
                <form action="{{ url_for('delete_transaction', transaction_id=t.id, student_id=student_id) }}" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this transaction?');">
                    <button type="submit" class="btn delete-btn">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>

    <!-- Reset Password Button -->
    <p><a href="{{ url_for('reset_student_password', student_id=student_id) }}" class="btn" style="background-color: #f0ad4e; color: white;">Reset Password</a></p>

    <!-- Delete Student Account -->
    <form action="{{ url_for('delete_student', student_id=student_id) }}" method="POST"
          onsubmit="return confirm('Are you sure you want to delete {{ student_name }}? This cannot be undone.');"
          style="margin-top: 20px;">
        <button type="submit" style="background-color: #f44336; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">
            Delete Account
        </button>
    </form>
</body>
</html>
